<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="start-page.html">
<link rel="import" href="app-footer.html">
<link rel="import" href="app-toolbar.html">
<link rel="import" href="game-login.html">
<link rel="import" href="realm-list.html">
<link rel="import" href="character-list.html">
<link rel="import" href="game-view.html">
<link rel="import" href="patch-download.html">
<link rel="import" href="error-dialog.html">
<link rel="import" href="offline-view.html">

<link rel="import" href="../style/theme.html">

<!--
    @author Robin Duda
    Polymer element for use as a login box.
 -->

<dom-module id="app-view">
    <link rel="import" href="../style/theme.css" type="css">
    <link rel="import" href="../style/style.css" type="css">
    <template>
        <style>
            :host {
                display: block;
                background-image: url("/src/images/background.png");
                background-repeat: repeat-x;
                background-attachment: fixed;
                width: 100%;
                min-height: 100vh;
            }

            #toolbar {
                z-index: 100;
            }

            #footer {
                z-index: 100;
            }

        </style>

        <template is="dom-if" if="{{!_gameVisible(view)}}">
            <app-toolbar id="toolbar"></app-toolbar>
        </template>

        <iron-pages selected="{{view}}" attr-for-selected="id" id="content">
            <div id="start-page">
                <start-page class="layout horizontal center-justified"/>
            </div>

            <div id="game-login">
                <game-login class="layout horizontal center-justified"/>
            </div>

            <div id="realm-list">
                <realm-list class="layout horizontal center-justified"/>
            </div>

            <div id="character-list">
                <character-list class="layout horizontal center-justified"/>
            </div>

            <div id="patch-download">
                <patch-download class="layout horizontal center-justified"/>
            </div>

            <div id="game-view" style="width: 100%; height: 100%;">
                <game-view/>
            </div>

            <div id="offline-view">
                <offline-view class="layout horizontal center-justified"/>
            </div>
        </iron-pages>


        <div id="error-dialog">
            <error-dialog/>
        </div>

        <template is="dom-if" if="{{!_gameVisible(view)}}">
            <app-footer id="footer"></app-footer>
        </template>

    </template>
    <script>
        class AppView extends Polymer.Element {

            static get is() {
                return 'app-view';
            }

            ready() {
                super.ready();
                let start = (application.development.skipStart) ? 'game-login' : 'start-page';
                this.view = (window.isPWA) ? 'game-login' : start;

                application.subscribe('view', (view) => {
                    this.view = view;
                });
            }

            _gameVisible() {
                return this.view === 'game-view';
            }

        }

        window.customElements.define(AppView.is, AppView);


    </script>
</dom-module>